"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const axios_1 = __importDefault(require("axios"));
const botRequest_1 = __importDefault(require("./botRequest"));
const botResponse_1 = __importDefault(require("./botResponse"));
class Gateway {
    constructor(gatewayUrl, serviceId) {
        this.serviceId = 'GenericBot';
        this.query = async (message) => {
            message.computeValues(this.serviceId);
            const response = await axios_1.default.post('/message', message.payload);
            return Gateway.parseResponse(response.data);
        };
        axios_1.default.defaults.baseURL = gatewayUrl || 'http://localhost:3000';
        this.serviceId = serviceId !== null && serviceId !== void 0 ? serviceId : this.serviceId;
        botRequest_1.default.serviceId = this.serviceId;
    }
    static parseResponse(jsonResponse) {
        return Object.assign(new botResponse_1.default(), jsonResponse);
    }
}
exports.default = Gateway;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2F0ZXdheS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9saWIvZ2F0ZXdheS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLGtEQUEwQjtBQUUxQiw4REFBc0M7QUFDdEMsZ0VBQXdDO0FBRXhDLE1BQXFCLE9BQU87SUFHMUIsWUFBWSxVQUFtQixFQUFFLFNBQWtCO1FBRjNDLGNBQVMsR0FBRyxZQUFZLENBQUM7UUFReEIsVUFBSyxHQUFHLEtBQUssRUFBRSxPQUFtQixFQUF3QixFQUFFO1lBQ25FLE9BQU8sQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQ3RDLE1BQU0sUUFBUSxHQUFHLE1BQU0sZUFBSyxDQUFDLElBQUksQ0FBQyxVQUFVLEVBQUUsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBQy9ELE9BQU8sT0FBTyxDQUFDLGFBQWEsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDOUMsQ0FBQyxDQUFDO1FBVEEsZUFBSyxDQUFDLFFBQVEsQ0FBQyxPQUFPLEdBQUcsVUFBVSxJQUFJLHVCQUF1QixDQUFDO1FBQy9ELElBQUksQ0FBQyxTQUFTLEdBQUcsU0FBUyxhQUFULFNBQVMsY0FBVCxTQUFTLEdBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQztRQUM3QyxvQkFBVSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDO0lBQ3hDLENBQUM7SUFRTyxNQUFNLENBQUMsYUFBYSxDQUFDLFlBQXFCO1FBQ2hELE9BQU8sTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLHFCQUFXLEVBQUUsRUFBRSxZQUFZLENBQUMsQ0FBQztJQUN4RCxDQUFDO0NBQ0Y7QUFsQkQsMEJBa0JDIn0=